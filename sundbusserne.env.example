# SharePoint Backup Configuration - Example File
# Copy this file to sundbusserne.env and fill in your actual values
# DO NOT commit sundbusserne.env to version control (it contains secrets)

GENERIC_SECRET=your-generic-client-secret-here

# SharePoint site URL (e.g., https://contoso.sharepoint.com/sites/YourSite)
# SHAREPOINT_SITE_URL=https://yourtenant.sharepoint.com/sites/yoursite
# Azure AD App Registration credentials
SHAREPOINT_TENANT_ID=your-tenant-id-here
SHAREPOINT_CLIENT_ID=your-client-id-here
SHAREPOINT_CLIENT_SECRET=your-client-secret-here

# Backup directory (optional, defaults to "backup")
BACKUP_DIR=BACKUP

# Dataverse Backup Configuration
# Copy this file to .env and fill in your actual values

# Dataverse environment URL (e.g., https://contoso.crm.dynamics.com)
DATAVERSE_ENVIRONMENT_URL=https://org.crm.dynamics.com

# Azure AD Tenant ID (from Azure Portal)
DATAVERSE_TENANT_ID=$GENERIC_TENANT_ID
DATAVERSE_CLIENT_ID=$GENERIC_CLIENT_ID
DATAVERSE_CLIENT_SECRET=$GENERIC_SECRET

# SharePoint Site URL
# SHAREPOINT_SITE_URL=https://your-tenant.sharepoint.com/sites/your-site

# Backup Configuration
SHAREPOINT_BACKUP_DIR=BACKUP/sharepoint
SHAREPOINT_MAX_ITEMS_PER_LIST=50000
SHAREPOINT_INCLUDE_DOCUMENTS=true
SHAREPOINT_DOCUMENTS_DIR=documents

# Optional: Specific lists to backup (comma-separated)
# Leave empty to backup all lists
SHAREPOINT_LISTS_TO_BACKUP=

# Optional: Lists to exclude (comma-separated)
SHAREPOINT_LISTS_TO_EXCLUDE=

# Optional: Backup only modified items since date (YYYY-MM-DD)
SHAREPOINT_MODIFIED_SINCE=

# Logging
SHAREPOINT_LOG_LEVEL=INFO
# Exchange/Outlook Backup Configuration
# Copy this file to .env.exchange and fill in your values

# ============================================
# Azure AD App Registration Configuration
# ============================================

# Tenant ID (Directory ID) from Azure AD
# Format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
EXCHANGE_TENANT_ID=your-tenant-id-here

# Application (Client) ID from Azure AD App Registration
# Format: xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
EXCHANGE_CLIENT_ID=your-client-id-here

# Client Secret from Azure AD App Registration
# IMPORTANT: Never commit this to version control!
EXCHANGE_CLIENT_SECRET=your-client-secret-here

# ============================================
# Backup Configuration
# ============================================

# Base directory for Exchange backups
# Default: backup/exchange
EXCHANGE_BACKUP_DIR=BACKUP/exchange

# Specific user to backup (optional)
# If empty, will backup all users in the tenant
# Format: user@yourdomain.com
EXCHANGE_USER_EMAIL=

# Include email attachments in backup
# true: Download attachments (recommended for full backup)
# false: Skip attachments (faster, smaller backups)
EXCHANGE_INCLUDE_ATTACHMENTS=true

# Maximum number of emails to backup per user per run
# Prevents runaway backups for large mailboxes
# 0 = no limit (not recommended)
EXCHANGE_MAX_EMAILS_PER_BACKUP=0

# Skip emails that are already marked as read
# true: Only backup unread emails (useful for incremental)
# false: Backup all emails regardless of read status
EXCHANGE_SKIP_ALREADY_READ=false

# Backup folder structure
# true: Preserve mailbox folder hierarchy
# false: Flatten all emails into single directory
EXCHANGE_PRESERVE_FOLDER_STRUCTURE=true

# ============================================
# Graph API Configuration
# ============================================

# Graph API endpoint (usually don't change this)
EXCHANGE_GRAPH_ENDPOINT=https://graph.microsoft.com/v1.0

# Batch size for Graph API requests
# Larger batches = faster but more memory usage
EXCHANGE_BATCH_SIZE=20

# Rate limiting delay between batches (seconds)
# Prevents hitting Graph API rate limits
EXCHANGE_RATE_LIMIT_DELAY=1

# Maximum retry attempts for failed requests
EXCHANGE_MAX_RETRIES=3

# ============================================
# Email Filtering (Optional)
# ============================================

# Only backup emails received after this date
# Format: YYYY-MM-DD or empty for all emails
EXCHANGE_FILTER_DATE_FROM=

# Only backup emails received before this date
# Format: YYYY-MM-DD or empty for all emails
EXCHANGE_FILTER_DATE_TO=

# Filter by sender email address (regex pattern)
# Example: .*@yourdomain\.com
EXCHANGE_FILTER_SENDER=

# Filter by subject (regex pattern)
EXCHANGE_FILTER_SUBJECT=

# ============================================
# Output Format
# ============================================

# Backup format
# eml: Standard .eml files (compatible with most email clients)
# json: Structured JSON with metadata (better for search/analysis)
# both: Create both .eml and .json files
EXCHANGE_BACKUP_FORMAT=both

# Compress backup files
# true: Create .zip archives for each folder
# false: Store as individual files
EXCHANGE_COMPRESS_BACKUPS=false

# ============================================
# Logging & Monitoring
# ============================================

# Log level: DEBUG, INFO, WARNING, ERROR
EXCHANGE_LOG_LEVEL=INFO

# Log file location
EXCHANGE_LOG_FILE=exchange_backup.log

# Enable detailed progress reporting
EXCHANGE_SHOW_PROGRESS=true

# Send email notifications on backup completion
# Requires SMTP configuration below
EXCHANGE_SEND_NOTIFICATIONS=false

# ============================================
# SMTP Configuration (for notifications)
# ============================================

# SMTP server for email notifications
EXCHANGE_SMTP_SERVER=smtp.yourdomain.com
EXCHANGE_SMTP_PORT=587
EXCHANGE_SMTP_USERNAME=your-smtp-username
EXCHANGE_SMTP_PASSWORD=your-smtp-password
EXCHANGE_NOTIFICATION_EMAIL=admin@yourdomain.com

# ============================================
# Incremental Backup Configuration
# ============================================

# Enable incremental backup using checksum database
# true: Only backup new/changed emails
# false: Full backup every time
EXCHANGE_INCREMENTAL_BACKUP=true

# Checksum database file location
EXCHANGE_CHECKSUM_DB=backup_checksums_exchange.db

# ============================================
# Security Configuration
# ============================================

# Encrypt backup files
# true: Encrypt backup files with provided password
# false: Store backups in plain text
EXCHANGE_ENCRYPT_BACKUPS=false

# Encryption password (if ENCRYPT_BACKUPS=true)
# IMPORTANT: Store this securely, not in this file for production!
EXCHANGE_ENCRYPTION_PASSWORD=

# ============================================
# Advanced Configuration
# ============================================

# Timeout for Graph API requests (seconds)
EXCHANGE_REQUEST_TIMEOUT=30

# Maximum attachment size to download (MB)
# Graph API limit is typically 4MB
EXCHANGE_MAX_ATTACHMENT_SIZE=4

# Backup calendar items (meetings, appointments)
# Requires additional Calendar.Read permission
EXCHANGE_BACKUP_CALENDAR=false

# Backup contacts
# Requires additional Contacts.Read permission
EXCHANGE_BACKUP_CONTACTS=false

# Backup tasks
# Requires additional Tasks.Read permission
EXCHANGE_BACKUP_TASKS=false